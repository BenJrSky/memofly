{"remainingRequest":"/Users/ben/Desktop/BEN/WORKS/FLYIP/VUE/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ben/Desktop/BEN/WORKS/FLYIP/VUE/src/components/CalendarSet.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/ben/Desktop/BEN/WORKS/FLYIP/VUE/src/components/CalendarSet.vue","mtime":1632248241593},{"path":"/Users/ben/Desktop/BEN/WORKS/FLYIP/VUE/node_modules/cache-loader/dist/cjs.js","mtime":1632248233346},{"path":"/Users/ben/Desktop/BEN/WORKS/FLYIP/VUE/node_modules/babel-loader/lib/index.js","mtime":1632248232528},{"path":"/Users/ben/Desktop/BEN/WORKS/FLYIP/VUE/node_modules/ts-loader/index.js","mtime":1632248240050},{"path":"/Users/ben/Desktop/BEN/WORKS/FLYIP/VUE/node_modules/cache-loader/dist/cjs.js","mtime":1632248233346},{"path":"/Users/ben/Desktop/BEN/WORKS/FLYIP/VUE/node_modules/vue-loader/lib/index.js","mtime":1632248240770}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7IENvbXBvbmVudCwgUHJvcCwgVnVlIH0gZnJvbSAndnVlLXByb3BlcnR5LWRlY29yYXRvcic7CmltcG9ydCB7IEdFVFVzZXIgfSBmcm9tICIuLi9tZW1vRmx5LWFwaS9HRVRVc2VyLmpzIjsKaW1wb3J0IHsgR0VUQ2FsZW5kYXJzIH0gZnJvbSAiLi4vbWVtb0ZseS1hcGkvR0VUQ2FsZW5kYXJzLmpzIjsKaW1wb3J0IHsgUFVUQ2FsZW5kYXJzIH0gZnJvbSAiLi4vbWVtb0ZseS1hcGkvUFVUQ2FsZW5kYXJzLmpzIjsKCmltcG9ydCB7IFRvYXN0IH0gZnJvbSAiLi4vc2VydmljZXMvVG9hc3QuanMiOwoKQENvbXBvbmVudCh7CiAgICBjb21wb25lbnRzOiB7CiAgICB9LAp9KQoKCmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhbGVuZGFyU2V0IGV4dGVuZHMgVnVlIHsKCiAgICBwdWJsaWMgc2VydmljZXMgOmFueTsKICAgIHB1YmxpYyBkYXRhU2VydmljZXMgOmFueTsKICAgIHB1YmxpYyBzZXJ2aWNlIDphbnk7CiAgICBwdWJsaWMgY293b3JrZXJzIDphbnk7CiAgICBwdWJsaWMgZGlzYWJsZWQgOmFueSA9IHRydWU7CiAgICBwdWJsaWMgY29tcGFueTogYW55ID0gW107CiAgICBwdWJsaWMgY2FsZW5kYXJMaXN0IDogYW55ID0gW107CiAgICBwdWJsaWMgc2VsZWN0ZWRDYWxlbmRhcnMgOiBhbnkgPSBbXTsKICAgIHB1YmxpYyBjYWxlbmRhckxpbWl0OiBudW1iZXIgPSAwOwoKICAgIGRhdGEoKSB7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgY29tcGFueTogdGhpcy5jb21wYW55LAogICAgICAgICAgICBjYWxlbmRhckxpc3Q6IHRoaXMuY2FsZW5kYXJMaXN0LAogICAgICAgICAgICBjYWxlbmRhckxpbWl0OiB0aGlzLmNhbGVuZGFyTGltaXQsCiAgICAgICAgICAgIHNlbGVjdGVkQ2FsZW5kYXJzOiB0aGlzLnNlbGVjdGVkQ2FsZW5kYXJzLAogICAgICAgIH0KICAgICAgICAKICAgIH0KCiAgICBtb3VudGVkKCkgewoKICAgICAgICB0aGlzLmRpc2FibGVkID0gdHJ1ZTsKCiAgICAgICAgR0VUVXNlcigpCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlOiBhbnkpID0+IHsKCiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NVc2VyKHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5jb21wYW55ID0gW107CiAgICAgICAgICAgIH0KCiAgICAgICAgfSkuZmluYWxseSgoKT0+ewoKICAgICAgICAgICAgR0VUQ2FsZW5kYXJzKCkKICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZTphbnkpPT57CgogICAgICAgICAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJMaXN0ID0gW107CgogICAgICAgICAgICAgICAgICAgIGZvcihsZXQgY2FsZW5kYXJOYW1lIGluIHJlc3BvbnNlLmRhdGEuaWRDb25Ob21pKXsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhckxpc3QucHVzaCh7aWQ6IGNhbGVuZGFyTmFtZSwgYWN0aXZlOmZhbHNlfSkKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRDYWxlbmRhcnMgPSByZXNwb25zZS5kYXRhLmNhbGVuZGFyaS5tYXAoKGl0ZW06YW55KT0+ewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGl0ZW0uY2FsZW5kYXJpbwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC5maW5hbGx5KCgpPT57CgogICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IHNlbGVjdGVkIG9mIHRoaXMuc2VsZWN0ZWRDYWxlbmRhcnMpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBjYWxlbmRhciBvZiB0aGlzLmNhbGVuZGFyTGlzdCl7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlbGVjdGVkLmlkID09PSBjYWxlbmRhci5pZCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGVuZGFyLmFjdGl2ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgCgogICAgICAgIH0pOwogICAgICAgIAogICAgfQoKICAgIHByb2Nlc3NVc2VyKGNvbXBhbnkpewoKICAgICAgICBsZXQgcmVzdWx0ID0ge307CgogICAgICAgIC8vRk9STUFUVElORyAKICAgICAgICBpZihjb21wYW55KXsKICAgICAgICBjb21wYW55LnNvdHRvc2NyaXppb25lID0gY29tcGFueS5zb3R0b3Njcml6aW9uZS5yZXBsYWNlKCJNZW1vZmx5IiwiIik7CiAgICAgICAgfWVsc2V7CiAgICAgICAgY29tcGFueSA9IHt9OwogICAgICAgIH0KCiAgICAgICAgbGV0IGNhbGVuZGFyU3RyaW5nID0gIiI7CgogICAgICAgIHRoaXMuY2FsZW5kYXJMaW1pdCA9IGNvbXBhbnkubnVtQ2FsZW5kYXJpOwoKICAgICAgICBpZihjb21wYW55Lm51bUNhbGVuZGFyaSA8PTEgKXsKICAgICAgICAgICAgY2FsZW5kYXJTdHJpbmcgPSBjb21wYW55Lm51bUNhbGVuZGFyaSArICIgY2FsZW5kYXJpbyI7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIGNhbGVuZGFyU3RyaW5nID0gY29tcGFueS5udW1DYWxlbmRhcmkgKyAiIGNhbGVuZGFyaSI7CiAgICAgICAgfQoKICAgICAgICByZXN1bHQgPSB7IAogICAgICAgICAgICAuLi5jb21wYW55LCAgCiAgICAgICAgICAgIGNhbGVuZGFyaTogY2FsZW5kYXJTdHJpbmcKICAgICAgICB9OwoKICAgICAgICB0aGlzLmNvbXBhbnkgPSByZXN1bHQ7CgogICAgfQoKICAgIHVwZGF0ZSgpewoKICAgICAgICBsZXQgc2VsZWN0ZWRDYWxlbmRhcnMgPSB0aGlzLmNhbGVuZGFyTGlzdC5maWx0ZXIoY2FsZW5kYXIgPT4gY2FsZW5kYXIuYWN0aXZlID09PSB0cnVlKTsKICAgICAgICBsZXQgc2VsZWN0ZWROdW1iZXIgPSBzZWxlY3RlZENhbGVuZGFycy5sZW5ndGg7CgogICAgICAgIGlmKHNlbGVjdGVkTnVtYmVyID4gdGhpcy5jYWxlbmRhckxpbWl0KXsgCgogICAgICAgICAgICBUb2FzdCh7c3RhdHVzOiA0MDB9LHtzdWNjZXNzOiJDYWxlbmRhcmkgYWdnaW9ybmF0aSBjb24gc3VjY2Vzc28iLGVycm9yOiJIYWkgc2VsZXppb25hdG8gIitzZWxlY3RlZE51bWJlcisiIGNhbGVuZGFyaSBpbnZlY2UgY2hlICIrdGhpcy5jYWxlbmRhckxpbWl0fSk7CgogICAgICAgIH1lbHNlewogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IHByb21pc2VzOiBhbnkgPSBbXTsKCiAgICAgICAgICAgIGxldCBjYWxlbmRhcnM6IGFueSA9IHt9OwoKICAgICAgICAgICAgbGV0IGluZGV4ID0gMTsKCiAgICAgICAgICAgIGZvcihsZXQgY2FsZW5kYXIgb2Ygc2VsZWN0ZWRDYWxlbmRhcnMpewogICAgICAgICAgICAgICAgY2FsZW5kYXJzW2luZGV4XSA9IGNhbGVuZGFyLmlkOwogICAgICAgICAgICAgICAgaW5kZXgrKzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgUFVUQ2FsZW5kYXJzKGNhbGVuZGFycykudGhlbihyZXN1bHQ9PnsKCiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHJlc3VsdFswXTsKCiAgICAgICAgICAgICAgICBpZihkYXRhICYmIGRhdGEuY2hhbmdlZFJvd3MpewogICAgICAgICAgICAgICAgICAgIFRvYXN0KHtzdGF0dXM6IDIwMH0se3N1Y2Nlc3M6IkNhbGVuZGFyaSBhZ2dpb3JuYXRpIGNvbiBzdWNjZXNzbyJ9KTsKICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIFRvYXN0KHtzdGF0dXM6IDQwMH0se2Vycm9yOiJFcnJvcmUgZHVyYW50ZSJ9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0pOwoKCiAgICAgICAgfQoKICAgIH0KICAgICAgICAgICAgCgoKCgogIAoKfQo="},{"version":3,"sources":["CalendarSet.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;;AAEA;;;;;;;;AAQA","file":"CalendarSet.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"row\">\n    <div class=\"card col-12\">\n        <div class=\"card-body col-12 p-4\">\n            <div class=\"row\">\n                <div class=\"col-sm-12 col-md-6\">\n                    <div class=\"form-group\">\n                        <h4 class=\"mt-0 header-title font-roboto weight-700 size-17\">Calendari</h4>\n                        <small class=\"form-text text-muted font-poppins weight-400 size-14\">Sei connesso al Google Account laurarossihair@gmail.com il tuo abbonamento prevede un massimo di {{ company.calendari}} </small>\n                    </div>            \n                </div>\n            </div>\n            <div class=\"row mt-3\">\n                <div class=\"col-sm-12\">\n                    <div class=\"form-group\">\n                        <div class=\"row col-12\">\n                            <h4 class=\"mt-0 header-title font-roboto weight-700 size-17\">Tutti i calendari</h4>\n                            <h4 class=\"mt-0 header-title font-roboto weight-700 size-17 right-0\">Seleziona al massimo {{ company.calendari}}</h4>\n                        </div>\n                          <div class=\"col-12 pl-0\">\n                            <div v-for=\"calendar in calendarList\" :key=\"calendar\" class=\"row m-0 pl-0 pr-0\">\n                                <div class=\"custom-control custom-checkbox border m-0 p-2 w-100\">\n                                    <input type=\"checkbox\" v-bind:id=\"calendar.id\" v-model=\"calendar.active\" class=\"custom-control-input custom-calendar\">\n                                    <label class=\"custom-control-label font-poppins weight-400 size-14\" v-bind:for=\"calendar.id\">{{ calendar.id }}</label>\n                                </div>\n                            </div>\n                         </div>\n                \n                    </div>            \n                </div>\n                 <div class=\"col-12 mb-3\">\n                    <button type=\"submit\" class=\"btn btn-gradient-primary mr-2 float-right font-poppins weight-700 size-14\" v-on:click=\"update()\">Aggiorna</button>\n                </div>\n            </div>\n        </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\n    import { Component, Prop, Vue } from 'vue-property-decorator';\n    import { GETUser } from \"../memoFly-api/GETUser.js\";\n    import { GETCalendars } from \"../memoFly-api/GETCalendars.js\";\n    import { PUTCalendars } from \"../memoFly-api/PUTCalendars.js\";\n\n    import { Toast } from \"../services/Toast.js\";\n\n    @Component({\n        components: {\n        },\n    })\n\n\n    export default class CalendarSet extends Vue {\n\n        public services :any;\n        public dataServices :any;\n        public service :any;\n        public coworkers :any;\n        public disabled :any = true;\n        public company: any = [];\n        public calendarList : any = [];\n        public selectedCalendars : any = [];\n        public calendarLimit: number = 0;\n\n        data() {\n            \n            return {\n                company: this.company,\n                calendarList: this.calendarList,\n                calendarLimit: this.calendarLimit,\n                selectedCalendars: this.selectedCalendars,\n            }\n            \n        }\n\n        mounted() {\n\n            this.disabled = true;\n\n            GETUser()\n            .then((response: any) => {\n\n                if (response.status == 200) {\n                    this.processUser(response.data);\n                } else {\n                    this.company = [];\n                }\n\n            }).finally(()=>{\n\n                GETCalendars()\n                    .then((response:any)=>{\n\n                        this.calendarList = [];\n\n                        for(let calendarName in response.data.idConNomi){\n                            this.calendarList.push({id: calendarName, active:false})\n                        }\n\n                        this.selectedCalendars = response.data.calendari.map((item:any)=>{\n                            return {\n                                id: item.calendario\n                            }\n                        });\n\n                    })\n                    .finally(()=>{\n\n                            for(let selected of this.selectedCalendars){\n                                for(let calendar of this.calendarList){\n\n                                    if(selected.id === calendar.id){\n                                        calendar.active = true;\n                                    }\n\n                                }\n                            }\n\n                    });\n                    \n\n            });\n            \n        }\n\n        processUser(company){\n\n            let result = {};\n\n            //FORMATTING \n            if(company){\n            company.sottoscrizione = company.sottoscrizione.replace(\"Memofly\",\"\");\n            }else{\n            company = {};\n            }\n\n            let calendarString = \"\";\n\n            this.calendarLimit = company.numCalendari;\n\n            if(company.numCalendari <=1 ){\n                calendarString = company.numCalendari + \" calendario\";\n            }else{\n                calendarString = company.numCalendari + \" calendari\";\n            }\n\n            result = { \n                ...company,  \n                calendari: calendarString\n            };\n\n            this.company = result;\n\n        }\n\n        update(){\n\n            let selectedCalendars = this.calendarList.filter(calendar => calendar.active === true);\n            let selectedNumber = selectedCalendars.length;\n\n            if(selectedNumber > this.calendarLimit){ \n\n                Toast({status: 400},{success:\"Calendari aggiornati con successo\",error:\"Hai selezionato \"+selectedNumber+\" calendari invece che \"+this.calendarLimit});\n\n            }else{\n                \n                let promises: any = [];\n\n                let calendars: any = {};\n\n                let index = 1;\n\n                for(let calendar of selectedCalendars){\n                    calendars[index] = calendar.id;\n                    index++;\n                }\n\n                PUTCalendars(calendars).then(result=>{\n\n                    let data = result[0];\n\n                    if(data && data.changedRows){\n                        Toast({status: 200},{success:\"Calendari aggiornati con successo\"});\n                    }else{\n                        Toast({status: 400},{error:\"Errore durante\"});\n                    }\n\n                });\n\n\n            }\n\n        }\n                \n    \n\n\n\n      \n\n    }\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped lang=\"scss\">\n\n</style>\n"]}]}